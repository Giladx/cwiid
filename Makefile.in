#Copyright (C) 2007 L. Donnie Smith

COMMON = @top_builddir@/common
include $(COMMON)/include/defs.mak

LIB_DIRS = wiimote
BIN_DIRS = wmgui wminput

all install clean distclean uninstall: TARGET += $(MAKECMDGOALS)

all install clean distclean uninstall: $(BIN_DIRS) $(LIB_DIRS)

all clean distclean: wmdemo

ifneq ($(MAKECMDGOALS),clean)
ifneq ($(MAKECMDGOALS),distclean)
$(BIN_DIRS): $(LIB_DIRS)
endif
endif

ifeq ($(MAKECMDGOALS),install)
$(BIN_DIRS) $(LIB_DIRS): $(CWIID_CONFIG_DIR) $(CWIID_PLUGINS_DIR)
endif

$(LIB_DIRS) $(BIN_DIRS) wmdemo:
	$(MAKE) $(TARGET) -C $@

$(CWIID_CONFIG_DIR):
	mkdir -p $(CWIID_CONFIG_DIR)

$(CWIID_PLUGINS_DIR):
	mkdir -p $(CWIID_PLUGINS_DIR)

distclean:
	rm -rf Makefile config.log config.status autom4te.cache $(COMMON)/include/defs.mak

uninstall:
	rm -r $(CWIID_PLUGINS_DIR); true

uninstall_config:
	rm -rf $(CWIID_CONFIG_DIR)

.PHONY: all install clean distclean uninstall uninstall_config $(LIB_DIRS) \
	$(BIN_DIRS) wmdemo
